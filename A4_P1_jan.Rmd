---
title: "A4_P1_jan"
author: "JK"
date: "2 listopadu 2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(pacman)
p_load(tidyverse,
       groupdata2) #downsampling
```

# DATA LOADING
chunks:
- files) create list of filenames
- loading function) function to import and clean one csv file
- 
```{r files}
## list of file names
files <- list.files(path = "data/", pattern="*.csv", full.names = T)
```

```{r loading function}
read_heart <- function(filename) {
    raw <- read_csv(filename,
                    col_types = list(time = col_double(),
                                     Resp1 = col_double(),
                                     Resp2 = col_double(),
                                     ECG1 = col_double(),
                                     ECG2 = col_double(),
                                     ReadingStart = col_integer(),
                                     ReadingStop = col_integer(),
                                     HR1 = col_double(),
                                     HR2 = col_double()))
    name <- as.character(filename)
    
    data <- cbind(raw, name) %>%
      mutate(nrow = nrow(raw)) #%>%
      #summarise()
    
    data <- data %>%
      mutate(name = str_remove_all(name, "data/"),
         name = str_remove_all(name, ".csv")) %>%
      
      mutate(study = substr(name, 6, 6),
         group = substr(name, 9, 10),
         group = str_remove_all(group, "_"),
         t = substr(name, 12, 12),
         condition = substr(name, 14, 30)) %>%
      
      select(-name)
    
    return(data)
}

```

```{r running}
all <- map_df(files, read_heart) 

study1 <- all %>%
  filter(study == "1") %>%
  select(-ReadingStart, -ReadingStop)

study2 <- all %>%
  filter(study == "2") #%>%
  #filter out 13820 NAs that appread exclusively in S2_G7_T3_TurnTaking
  #we're not discrarding any infromation, there are 13820 NAs in every column
  #filter(!is.na(time)) 
```


## DOWNSAMPLING

```{r}

```

